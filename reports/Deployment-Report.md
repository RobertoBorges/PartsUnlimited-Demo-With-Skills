# Deployment Report — PartsUnlimited to Azure

**Date:** February 18, 2026
**Deployment Target:** Azure Canada Central
**Platform:** Azure Kubernetes Service (AKS)
**Subscription:** non-prod-mfe-pfeborges (`3464f809-852d-45e3-846c-f5411419cc83`)

---

## Deployment Summary

| Resource | Name | Status |
|---|---|---|
| Resource Group | `rg-partsunlimited-dev` | ✅ Created |
| AKS Cluster (v1.32) | `aks-partsunlimited-dev` | ✅ Created |
| Azure Container Registry | `acrpartsunlimiteddevy5zz` | ✅ Created |
| Azure SQL Server | `sql-partsunlimited-dev` | ✅ Created |
| SQL Database | `sqldb-partsunlimited` | ✅ Created |
| Azure Key Vault | `kv-partsunlimited-dev` | ✅ Created |
| Log Analytics Workspace | `log-partsunlimited-dev` | ✅ Created |
| Application Insights | `appi-partsunlimited-dev` | ✅ Created |
| User-Assigned Managed Identity | `id-partsunlimited-dev-workload` | ✅ Created |
| VNet + Subnets | `vnet-partsunlimited-dev` | ✅ Created |
| Entra ID App Registration | `partsunlimited-dev` | ✅ Created |

---

## Application Deployment

| Component | Details | Status |
|---|---|---|
| Container Image | `acrpartsunlimiteddevy5zz.azurecr.io/partsunlimited:latest` | ✅ Built & Pushed |
| Helm Chart | `partsunlimited v1.0.0` (Revision 3) | ✅ Deployed |
| NGINX Ingress Controller | v4.x — 2 replicas | ✅ Running |
| App Pods | 2/2 Running, 0 restarts | ✅ Healthy |
| External IP | `20.48.128.13` (port 80/443) | ✅ Accessible |

---

## Kubernetes Resources

```
NAMESPACE     NAME                                            READY   STATUS
default       partsunlimited-6c9b58f79f-c74g7               1/1     Running
default       partsunlimited-6c9b58f79f-nccdr               1/1     Running
ingress-nginx ingress-nginx-controller-86d5d494d6-6769m      1/1     Running
ingress-nginx ingress-nginx-controller-86d5d494d6-b5qjz      1/1     Running
```

---

## Entra ID Configuration

| Setting | Value |
|---|---|
| Application Name | `partsunlimited-dev` |
| Client ID | `7b569f5c-78f1-4cf4-bf01-ea5c02350670` |
| Tenant ID | `7bf7ca02-20a6-4cc7-a35d-8fa9c5fd4529` |
| Redirect URI | `http://20.48.128.13/signin-oidc` |
| App Roles | Administrator |

---

## Security Configuration

| Item | Configuration |
|---|---|
| AKS Identity | SystemAssigned + Workload Identity (OIDC) |
| SQL Auth | Azure AD-only (no SQL auth) |
| Key Vault Access | RBAC (Secrets Officer + Secrets User) |
| Container Registry | AcrPull for AKS kubelet identity |
| TLS | NGINX TLS termination (self-signed dev cert) |

---

## Issues Encountered & Resolved

| # | Issue | Resolution |
|---|---|---|
| 1 | AKS Kubernetes 1.29 LTS-only in Canada Central | Upgraded to K8s v1.32 |
| 2 | SQL geo-redundant backups blocked by subscription policy | Changed to `Local` backup storage |
| 3 | Key Vault dynamic outbound NAT blocked firewall | Opened KV public access (RBAC secures it); created secrets via Azure CLI |
| 4 | Missing `.dockerignore` caused Windows obj/ conflict | Created `.dockerignore` to exclude build artifacts |
| 5 | App crash: invalid KV URI from appsettings.json placeholder | Fixed ConfigMap key from `KeyVault__VaultUri` → `Azure__KeyVault__VaultUri` |
| 6 | Helm/K8s providers timeout with dynamic AKS config | Switched to local kubeconfig (`az aks get-credentials`) |
| 7 | Duplicate ACR role assignment in AKS + ACR modules | Removed from ACR module; kept in AKS module |

---

## Access URLs

| Endpoint | URL | Notes |
|---|---|---|
| Application | `http://20.48.128.13/` | Requires `Host: partsunlimited.example.com` header for ingress routing |
| Azure Portal | [Resource Group](https://portal.azure.com/#resource/subscriptions/3464f809-852d-45e3-846c-f5411419cc83/resourceGroups/rg-partsunlimited-dev) | — |

---

## Recommended Next Steps

1. **DNS**: Map `partsunlimited-dev.canadacentral.cloudapp.azure.com` or custom domain to `20.48.128.13`
2. **TLS**: Replace self-signed cert with Let's Encrypt via cert-manager
3. **SQL Migration**: Run EF Core migrations to initialize the database schema
4. **Key Vault Security**: Re-enable private endpoint-only access for production
5. **CI/CD**: Proceed to Phase 5 — GitHub Actions pipeline setup

---

*Generated by Migration to Azure Agent — Phase 4 Complete*
